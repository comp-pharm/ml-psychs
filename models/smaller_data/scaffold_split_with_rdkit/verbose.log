Command line
python /home/ian/anaconda3/envs/chemprop/bin/chemprop_train --data_path data/interim/smaller_dataset/SMILES_to_Activity.csv --dataset_type classification --split_type scaffold_balanced --features_generator rdkit_2d_normalized --no_features_scaling --save_dir models/smaller_data/scaffold_split_with_rdkit/
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/interim/smaller_dataset/SMILES_to_Activity.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'models/smaller_data/scaffold_split_with_rdkit/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'scaffold_balanced',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['PUBCHEM_ACTIVITY_OUTCOME'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total scaffolds = 1,914 | train scaffolds = 1,558 | val scaffolds = 169 | test scaffolds = 187
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 42 | target average = 0.333333


Scaffold 1
Task 0: count = 23 | target average = 1.000000


Scaffold 2
Task 0: count = 16 | target average = 1.000000


Scaffold 3
Task 0: count = 15 | target average = 0.800000


Scaffold 4
Task 0: count = 9 | target average = 0.888889


Scaffold 5
Task 0: count = 9 | target average = 0.222222


Scaffold 6
Task 0: count = 8 | target average = 1.000000


Scaffold 7
Task 0: count = 8 | target average = 1.000000


Scaffold 8
Task 0: count = 6 | target average = 0.166667


Scaffold 9
Task 0: count = 6 | target average = 0.166667


Class sizes
PUBCHEM_ACTIVITY_OUTCOME 0: 81.16%, 1: 18.84%
Total size = 2,266 | train size = 1,812 | val size = 226 | test size = 228
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 415,201
Moving model to cuda
Epoch 0
Loss = 4.7253e-01, PNorm = 35.0699, GNorm = 0.6054, lr_0 = 2.3750e-04
Loss = 5.0832e-01, PNorm = 35.0720, GNorm = 0.9613, lr_0 = 3.6250e-04
Loss = 3.9788e-01, PNorm = 35.0872, GNorm = 1.6806, lr_0 = 4.8750e-04
Validation auc = 0.877653
Epoch 1
Loss = 4.0366e-01, PNorm = 35.1080, GNorm = 0.6799, lr_0 = 6.2500e-04
Loss = 3.7301e-01, PNorm = 35.1385, GNorm = 0.4242, lr_0 = 7.5000e-04
Loss = 3.7618e-01, PNorm = 35.1715, GNorm = 0.5304, lr_0 = 8.7500e-04
Loss = 3.6129e-01, PNorm = 35.2176, GNorm = 1.4363, lr_0 = 1.0000e-03
Validation auc = 0.871463
Epoch 2
Loss = 3.8919e-01, PNorm = 35.2762, GNorm = 0.3386, lr_0 = 9.7519e-04
Loss = 2.8560e-01, PNorm = 35.3362, GNorm = 0.3979, lr_0 = 9.5316e-04
Loss = 3.3319e-01, PNorm = 35.3744, GNorm = 0.4432, lr_0 = 9.3164e-04
Validation auc = 0.894562
Epoch 3
Loss = 2.5701e-01, PNorm = 35.4172, GNorm = 0.8764, lr_0 = 9.0852e-04
Loss = 3.2604e-01, PNorm = 35.4635, GNorm = 0.8271, lr_0 = 8.8800e-04
Loss = 3.1411e-01, PNorm = 35.5048, GNorm = 0.3502, lr_0 = 8.6794e-04
Loss = 2.9972e-01, PNorm = 35.5531, GNorm = 0.3597, lr_0 = 8.4834e-04
Validation auc = 0.905615
Epoch 4
Loss = 3.2131e-01, PNorm = 35.6076, GNorm = 1.2650, lr_0 = 8.2729e-04
Loss = 3.2491e-01, PNorm = 35.6541, GNorm = 0.4378, lr_0 = 8.0861e-04
Loss = 2.7996e-01, PNorm = 35.7049, GNorm = 0.5779, lr_0 = 7.9035e-04
Loss = 2.8794e-01, PNorm = 35.7521, GNorm = 0.5044, lr_0 = 7.7250e-04
Validation auc = 0.907935
Epoch 5
Loss = 2.7741e-01, PNorm = 35.8103, GNorm = 1.5392, lr_0 = 7.5505e-04
Loss = 2.7291e-01, PNorm = 35.8621, GNorm = 0.3659, lr_0 = 7.3800e-04
Loss = 3.1075e-01, PNorm = 35.8999, GNorm = 1.4420, lr_0 = 7.2133e-04
Validation auc = 0.908267
Epoch 6
Loss = 2.3723e-01, PNorm = 35.9668, GNorm = 0.2608, lr_0 = 7.0343e-04
Loss = 2.8646e-01, PNorm = 36.0192, GNorm = 0.4717, lr_0 = 6.8755e-04
Loss = 2.6554e-01, PNorm = 36.0702, GNorm = 0.5349, lr_0 = 6.7202e-04
Loss = 2.3689e-01, PNorm = 36.1363, GNorm = 0.2842, lr_0 = 6.5684e-04
Validation auc = 0.910477
Epoch 7
Loss = 2.0601e-01, PNorm = 36.2120, GNorm = 0.3482, lr_0 = 6.4054e-04
Loss = 2.6288e-01, PNorm = 36.2715, GNorm = 0.4451, lr_0 = 6.2608e-04
Loss = 2.8136e-01, PNorm = 36.3325, GNorm = 0.4719, lr_0 = 6.1194e-04
Validation auc = 0.910256
Epoch 8
Loss = 1.8328e-01, PNorm = 36.3849, GNorm = 0.4451, lr_0 = 5.9675e-04
Loss = 2.3282e-01, PNorm = 36.4378, GNorm = 0.8102, lr_0 = 5.8327e-04
Loss = 2.7487e-01, PNorm = 36.4896, GNorm = 0.4263, lr_0 = 5.7010e-04
Loss = 2.5585e-01, PNorm = 36.5425, GNorm = 0.4793, lr_0 = 5.5723e-04
Validation auc = 0.913683
Epoch 9
Loss = 2.1858e-01, PNorm = 36.5858, GNorm = 1.1657, lr_0 = 5.4464e-04
Loss = 2.3503e-01, PNorm = 36.6384, GNorm = 1.1336, lr_0 = 5.3234e-04
Loss = 2.8118e-01, PNorm = 36.6868, GNorm = 0.5073, lr_0 = 5.2032e-04
Loss = 2.2268e-01, PNorm = 36.7335, GNorm = 0.7937, lr_0 = 5.0857e-04
Validation auc = 0.909262
Epoch 10
Loss = 2.1522e-01, PNorm = 36.7985, GNorm = 0.6008, lr_0 = 4.9595e-04
Loss = 2.1869e-01, PNorm = 36.8540, GNorm = 0.8808, lr_0 = 4.8475e-04
Loss = 2.3973e-01, PNorm = 36.9013, GNorm = 0.4928, lr_0 = 4.7380e-04
Validation auc = 0.903957
Epoch 11
Loss = 1.5899e-01, PNorm = 36.9547, GNorm = 0.6948, lr_0 = 4.6204e-04
Loss = 2.4997e-01, PNorm = 37.0096, GNorm = 0.6372, lr_0 = 4.5161e-04
Loss = 2.0729e-01, PNorm = 37.0589, GNorm = 0.8546, lr_0 = 4.4141e-04
Loss = 2.1565e-01, PNorm = 37.0903, GNorm = 0.6468, lr_0 = 4.3144e-04
Validation auc = 0.913904
Epoch 12
Loss = 2.1083e-01, PNorm = 37.1391, GNorm = 0.9465, lr_0 = 4.2073e-04
Loss = 1.9454e-01, PNorm = 37.1773, GNorm = 0.3897, lr_0 = 4.1123e-04
Loss = 2.3171e-01, PNorm = 37.2153, GNorm = 0.7146, lr_0 = 4.0195e-04
Loss = 2.0642e-01, PNorm = 37.2670, GNorm = 0.4290, lr_0 = 3.9287e-04
Validation auc = 0.906941
Epoch 13
Loss = 2.2210e-01, PNorm = 37.3057, GNorm = 1.2597, lr_0 = 3.8399e-04
Loss = 2.0971e-01, PNorm = 37.3488, GNorm = 0.4080, lr_0 = 3.7532e-04
Loss = 2.0109e-01, PNorm = 37.3873, GNorm = 0.5607, lr_0 = 3.6685e-04
Validation auc = 0.910035
Epoch 14
Loss = 2.3382e-01, PNorm = 37.4283, GNorm = 0.4426, lr_0 = 3.5774e-04
Loss = 1.6746e-01, PNorm = 37.4610, GNorm = 0.4602, lr_0 = 3.4966e-04
Loss = 2.1238e-01, PNorm = 37.5012, GNorm = 0.6095, lr_0 = 3.4177e-04
Loss = 1.8043e-01, PNorm = 37.5362, GNorm = 0.3966, lr_0 = 3.3405e-04
Validation auc = 0.910035
Epoch 15
Loss = 1.9524e-01, PNorm = 37.5744, GNorm = 0.7902, lr_0 = 3.2576e-04
Loss = 1.7220e-01, PNorm = 37.6093, GNorm = 0.4117, lr_0 = 3.1840e-04
Loss = 1.7160e-01, PNorm = 37.6435, GNorm = 0.6339, lr_0 = 3.1121e-04
Validation auc = 0.911251
Epoch 16
Loss = 1.8379e-01, PNorm = 37.6773, GNorm = 0.5558, lr_0 = 3.0349e-04
Loss = 1.6840e-01, PNorm = 37.7126, GNorm = 0.6900, lr_0 = 2.9663e-04
Loss = 2.0009e-01, PNorm = 37.7449, GNorm = 1.2285, lr_0 = 2.8994e-04
Loss = 1.7297e-01, PNorm = 37.7722, GNorm = 0.5840, lr_0 = 2.8339e-04
Validation auc = 0.912246
Epoch 17
Loss = 1.2939e-01, PNorm = 37.8076, GNorm = 0.3307, lr_0 = 2.7699e-04
Loss = 1.6062e-01, PNorm = 37.8460, GNorm = 0.6299, lr_0 = 2.7073e-04
Loss = 1.8779e-01, PNorm = 37.8797, GNorm = 0.5088, lr_0 = 2.6462e-04
Loss = 1.9635e-01, PNorm = 37.9027, GNorm = 0.5890, lr_0 = 2.5864e-04
Validation auc = 0.912688
Epoch 18
Loss = 1.5154e-01, PNorm = 37.9351, GNorm = 0.5573, lr_0 = 2.5222e-04
Loss = 1.5466e-01, PNorm = 37.9638, GNorm = 0.5173, lr_0 = 2.4653e-04
Loss = 1.8538e-01, PNorm = 37.9897, GNorm = 0.6611, lr_0 = 2.4096e-04
Validation auc = 0.910035
Epoch 19
Loss = 1.5824e-01, PNorm = 38.0170, GNorm = 0.5395, lr_0 = 2.3498e-04
Loss = 1.4732e-01, PNorm = 38.0431, GNorm = 0.4708, lr_0 = 2.2967e-04
Loss = 1.7059e-01, PNorm = 38.0711, GNorm = 0.8748, lr_0 = 2.2449e-04
Loss = 1.4985e-01, PNorm = 38.0965, GNorm = 0.3195, lr_0 = 2.1942e-04
Validation auc = 0.915893
Epoch 20
Loss = 1.3381e-01, PNorm = 38.1187, GNorm = 0.4739, lr_0 = 2.1397e-04
Loss = 1.7754e-01, PNorm = 38.1426, GNorm = 0.8184, lr_0 = 2.0914e-04
Loss = 1.6249e-01, PNorm = 38.1717, GNorm = 0.5625, lr_0 = 2.0442e-04
Loss = 1.5452e-01, PNorm = 38.1953, GNorm = 0.7887, lr_0 = 1.9980e-04
Validation auc = 0.914898
Epoch 21
Loss = 1.4085e-01, PNorm = 38.2200, GNorm = 0.6429, lr_0 = 1.9529e-04
Loss = 1.5477e-01, PNorm = 38.2412, GNorm = 0.4706, lr_0 = 1.9088e-04
Loss = 1.4830e-01, PNorm = 38.2678, GNorm = 0.8033, lr_0 = 1.8657e-04
Validation auc = 0.912246
Epoch 22
Loss = 1.7713e-01, PNorm = 38.2914, GNorm = 0.4534, lr_0 = 1.8194e-04
Loss = 1.6571e-01, PNorm = 38.3153, GNorm = 1.9851, lr_0 = 1.7783e-04
Loss = 1.4837e-01, PNorm = 38.3363, GNorm = 0.4048, lr_0 = 1.7381e-04
Loss = 1.4543e-01, PNorm = 38.3580, GNorm = 0.6200, lr_0 = 1.6989e-04
Validation auc = 0.914014
Epoch 23
Loss = 1.4450e-01, PNorm = 38.3809, GNorm = 1.3974, lr_0 = 1.6567e-04
Loss = 1.6339e-01, PNorm = 38.3997, GNorm = 0.6003, lr_0 = 1.6193e-04
Loss = 1.4448e-01, PNorm = 38.4175, GNorm = 0.8273, lr_0 = 1.5827e-04
Validation auc = 0.914456
Epoch 24
Loss = 8.6138e-02, PNorm = 38.4369, GNorm = 0.8467, lr_0 = 1.5434e-04
Loss = 1.4273e-01, PNorm = 38.4549, GNorm = 0.9550, lr_0 = 1.5086e-04
Loss = 1.6914e-01, PNorm = 38.4694, GNorm = 0.5796, lr_0 = 1.4745e-04
Loss = 1.2836e-01, PNorm = 38.4877, GNorm = 0.8310, lr_0 = 1.4412e-04
Validation auc = 0.911583
Epoch 25
Loss = 1.5063e-01, PNorm = 38.5074, GNorm = 0.4397, lr_0 = 1.4087e-04
Loss = 1.2186e-01, PNorm = 38.5293, GNorm = 0.3219, lr_0 = 1.3769e-04
Loss = 1.4831e-01, PNorm = 38.5423, GNorm = 0.9346, lr_0 = 1.3458e-04
Loss = 1.3902e-01, PNorm = 38.5586, GNorm = 0.5856, lr_0 = 1.3154e-04
Validation auc = 0.909041
Epoch 26
Loss = 1.4429e-01, PNorm = 38.5742, GNorm = 0.6864, lr_0 = 1.2827e-04
Loss = 1.4295e-01, PNorm = 38.5915, GNorm = 1.0147, lr_0 = 1.2538e-04
Loss = 1.4601e-01, PNorm = 38.6039, GNorm = 0.8307, lr_0 = 1.2254e-04
Validation auc = 0.911141
Epoch 27
Loss = 1.1571e-01, PNorm = 38.6217, GNorm = 0.7457, lr_0 = 1.1950e-04
Loss = 1.3305e-01, PNorm = 38.6377, GNorm = 0.6933, lr_0 = 1.1680e-04
Loss = 1.2844e-01, PNorm = 38.6515, GNorm = 0.8904, lr_0 = 1.1417e-04
Loss = 1.3816e-01, PNorm = 38.6638, GNorm = 0.6344, lr_0 = 1.1159e-04
Validation auc = 0.914014
Epoch 28
Loss = 2.0502e-01, PNorm = 38.6746, GNorm = 0.7394, lr_0 = 1.0882e-04
Loss = 1.2131e-01, PNorm = 38.6866, GNorm = 0.5386, lr_0 = 1.0636e-04
Loss = 1.1192e-01, PNorm = 38.6994, GNorm = 0.5157, lr_0 = 1.0396e-04
Loss = 1.0536e-01, PNorm = 38.7116, GNorm = 0.2554, lr_0 = 1.0161e-04
Loss = 2.0617e-01, PNorm = 38.7127, GNorm = 0.8857, lr_0 = 1.0138e-04
Validation auc = 0.912688
Epoch 29
Loss = 1.0821e-01, PNorm = 38.7230, GNorm = 0.5580, lr_0 = 1.0000e-04
Loss = 1.2648e-01, PNorm = 38.7361, GNorm = 0.6553, lr_0 = 1.0000e-04
Loss = 1.3877e-01, PNorm = 38.7481, GNorm = 0.9323, lr_0 = 1.0000e-04
Validation auc = 0.909704
Model 0 best validation auc = 0.915893 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.921182
Ensemble test auc = 0.921182
1-fold cross validation
	Seed 0 ==> test auc = 0.921182
Overall test auc = 0.921182 +/- 0.000000
Elapsed time = 0:02:50
