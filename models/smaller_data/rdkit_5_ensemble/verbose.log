Command line
python /home/ian/anaconda3/envs/chemprop/bin/chemprop_train --data_path data/interim/smaller_dataset/SMILES_to_Activity.csv --dataset_type classification --features_generator rdkit_2d_normalized --no_features_scaling --save_dir models/smaller_data/rdkit_5_ensemble/
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/interim/smaller_dataset/SMILES_to_Activity.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'models/smaller_data/rdkit_5_ensemble/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['PUBCHEM_ACTIVITY_OUTCOME'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Command line
python /home/ian/anaconda3/envs/chemprop/bin/chemprop_train --data_path data/interim/smaller_dataset/SMILES_to_Activity.csv --dataset_type classification --features_generator rdkit_2d_normalized --no_features_scaling --ensemble_size 5 --save_dir models/smaller_data/rdkit_5_ensemble/
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/interim/smaller_dataset/SMILES_to_Activity.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 5,
 'epochs': 30,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'models/smaller_data/rdkit_5_ensemble/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['PUBCHEM_ACTIVITY_OUTCOME'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
PUBCHEM_ACTIVITY_OUTCOME 0: 81.16%, 1: 18.84%
Total size = 2,266 | train size = 1,812 | val size = 227 | test size = 227
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 415,201
Moving model to cuda
Epoch 0
Loss = 5.2034e-01, PNorm = 35.0686, GNorm = 0.4147, lr_0 = 2.3750e-04
Loss = 4.5027e-01, PNorm = 35.0741, GNorm = 0.9618, lr_0 = 3.6250e-04
Loss = 4.1347e-01, PNorm = 35.0876, GNorm = 0.9029, lr_0 = 4.8750e-04
Validation auc = 0.810920
Epoch 1
Loss = 4.4973e-01, PNorm = 35.1118, GNorm = 1.2597, lr_0 = 6.2500e-04
Loss = 3.6296e-01, PNorm = 35.1421, GNorm = 0.3962, lr_0 = 7.5000e-04
Loss = 3.9041e-01, PNorm = 35.1806, GNorm = 0.2782, lr_0 = 8.7500e-04
Loss = 3.2465e-01, PNorm = 35.2346, GNorm = 1.3224, lr_0 = 1.0000e-03
Validation auc = 0.845677
Epoch 2
Loss = 3.5095e-01, PNorm = 35.2942, GNorm = 0.5104, lr_0 = 9.7519e-04
Loss = 3.2517e-01, PNorm = 35.3449, GNorm = 0.4320, lr_0 = 9.5316e-04
Loss = 3.1466e-01, PNorm = 35.3946, GNorm = 0.3213, lr_0 = 9.3164e-04
Validation auc = 0.857685
Epoch 3
Loss = 4.6095e-01, PNorm = 35.4557, GNorm = 1.7579, lr_0 = 9.0852e-04
Loss = 3.3884e-01, PNorm = 35.5215, GNorm = 0.7782, lr_0 = 8.8800e-04
Loss = 2.6492e-01, PNorm = 35.5766, GNorm = 0.3609, lr_0 = 8.6794e-04
Loss = 3.1299e-01, PNorm = 35.6180, GNorm = 0.3691, lr_0 = 8.4834e-04
Validation auc = 0.858443
Epoch 4
Loss = 2.9223e-01, PNorm = 35.6646, GNorm = 0.4111, lr_0 = 8.2729e-04
Loss = 2.6751e-01, PNorm = 35.7120, GNorm = 0.6339, lr_0 = 8.0861e-04
Loss = 3.1926e-01, PNorm = 35.7584, GNorm = 0.2219, lr_0 = 7.9035e-04
Loss = 2.8888e-01, PNorm = 35.8018, GNorm = 0.7739, lr_0 = 7.7250e-04
Validation auc = 0.867669
Epoch 5
Loss = 2.4443e-01, PNorm = 35.8444, GNorm = 0.4691, lr_0 = 7.5505e-04
Loss = 2.9379e-01, PNorm = 35.8945, GNorm = 1.3184, lr_0 = 7.3800e-04
Loss = 3.0569e-01, PNorm = 35.9329, GNorm = 0.4728, lr_0 = 7.2133e-04
Validation auc = 0.867290
Epoch 6
Loss = 3.6690e-01, PNorm = 35.9752, GNorm = 0.6046, lr_0 = 7.0343e-04
Loss = 2.6836e-01, PNorm = 36.0193, GNorm = 1.1633, lr_0 = 6.8755e-04
Loss = 3.0358e-01, PNorm = 36.0673, GNorm = 0.7054, lr_0 = 6.7202e-04
Loss = 2.2725e-01, PNorm = 36.1247, GNorm = 0.4585, lr_0 = 6.5684e-04
Validation auc = 0.878033
Epoch 7
Loss = 1.9225e-01, PNorm = 36.2050, GNorm = 1.0881, lr_0 = 6.4054e-04
Loss = 3.4962e-01, PNorm = 36.2595, GNorm = 0.3745, lr_0 = 6.2608e-04
Loss = 2.6822e-01, PNorm = 36.3076, GNorm = 0.3514, lr_0 = 6.1194e-04
Validation auc = 0.878918
Epoch 8
Loss = 1.6127e-01, PNorm = 36.3604, GNorm = 0.4630, lr_0 = 5.9675e-04
Loss = 2.7889e-01, PNorm = 36.3970, GNorm = 0.6609, lr_0 = 5.8327e-04
Loss = 2.6254e-01, PNorm = 36.4423, GNorm = 1.0884, lr_0 = 5.7010e-04
Loss = 2.5259e-01, PNorm = 36.4788, GNorm = 0.5716, lr_0 = 5.5723e-04
Validation auc = 0.880814
Epoch 9
Loss = 1.8405e-01, PNorm = 36.5239, GNorm = 0.2954, lr_0 = 5.4464e-04
Loss = 2.3120e-01, PNorm = 36.5645, GNorm = 0.2766, lr_0 = 5.3234e-04
Loss = 2.7088e-01, PNorm = 36.6100, GNorm = 0.4448, lr_0 = 5.2032e-04
Loss = 2.3467e-01, PNorm = 36.6513, GNorm = 0.3735, lr_0 = 5.0857e-04
Validation auc = 0.884606
Epoch 10
Loss = 2.6171e-01, PNorm = 36.7006, GNorm = 0.7318, lr_0 = 4.9595e-04
Loss = 2.4943e-01, PNorm = 36.7416, GNorm = 2.6615, lr_0 = 4.8475e-04
Loss = 2.3895e-01, PNorm = 36.7793, GNorm = 0.2730, lr_0 = 4.7380e-04
Validation auc = 0.889914
Epoch 11
Loss = 2.3596e-01, PNorm = 36.8303, GNorm = 0.4175, lr_0 = 4.6204e-04
Loss = 2.2640e-01, PNorm = 36.8749, GNorm = 0.4020, lr_0 = 4.5161e-04
Loss = 2.1385e-01, PNorm = 36.9235, GNorm = 1.1503, lr_0 = 4.4141e-04
Loss = 2.3350e-01, PNorm = 36.9646, GNorm = 0.4709, lr_0 = 4.3144e-04
Validation auc = 0.883595
Epoch 12
Loss = 1.8739e-01, PNorm = 37.0024, GNorm = 0.6346, lr_0 = 4.2073e-04
Loss = 2.0337e-01, PNorm = 37.0340, GNorm = 0.3492, lr_0 = 4.1123e-04
Loss = 2.2323e-01, PNorm = 37.0678, GNorm = 1.1184, lr_0 = 4.0195e-04
Loss = 2.3770e-01, PNorm = 37.1102, GNorm = 0.3663, lr_0 = 3.9287e-04
Validation auc = 0.894590
Epoch 13
Loss = 2.2877e-01, PNorm = 37.1486, GNorm = 0.7798, lr_0 = 3.8399e-04
Loss = 1.8475e-01, PNorm = 37.1870, GNorm = 0.5214, lr_0 = 3.7532e-04
Loss = 2.1183e-01, PNorm = 37.2240, GNorm = 0.3871, lr_0 = 3.6685e-04
Validation auc = 0.896613
Epoch 14
Loss = 2.6104e-01, PNorm = 37.2556, GNorm = 0.5588, lr_0 = 3.5774e-04
Loss = 2.0746e-01, PNorm = 37.2902, GNorm = 0.8046, lr_0 = 3.4966e-04
Loss = 1.8309e-01, PNorm = 37.3229, GNorm = 0.6829, lr_0 = 3.4177e-04
Loss = 2.1987e-01, PNorm = 37.3565, GNorm = 1.5630, lr_0 = 3.3405e-04
Validation auc = 0.900531
Epoch 15
Loss = 2.1182e-01, PNorm = 37.3909, GNorm = 0.6937, lr_0 = 3.2576e-04
Loss = 1.8251e-01, PNorm = 37.4226, GNorm = 1.2206, lr_0 = 3.1840e-04
Loss = 1.9907e-01, PNorm = 37.4551, GNorm = 1.3934, lr_0 = 3.1121e-04
Validation auc = 0.896866
Epoch 16
Loss = 1.1992e-01, PNorm = 37.4899, GNorm = 0.3304, lr_0 = 3.0349e-04
Loss = 2.1771e-01, PNorm = 37.5242, GNorm = 0.7609, lr_0 = 2.9663e-04
Loss = 1.8545e-01, PNorm = 37.5576, GNorm = 0.4722, lr_0 = 2.8994e-04
Loss = 2.0076e-01, PNorm = 37.5872, GNorm = 0.7987, lr_0 = 2.8339e-04
Validation auc = 0.899520
Epoch 17
Loss = 2.2053e-01, PNorm = 37.6162, GNorm = 0.4052, lr_0 = 2.7699e-04
Loss = 1.7873e-01, PNorm = 37.6394, GNorm = 0.4877, lr_0 = 2.7073e-04
Loss = 1.7935e-01, PNorm = 37.6681, GNorm = 0.5167, lr_0 = 2.6462e-04
Loss = 1.8497e-01, PNorm = 37.6992, GNorm = 0.4015, lr_0 = 2.5864e-04
Validation auc = 0.902553
Epoch 18
Loss = 1.7241e-01, PNorm = 37.7338, GNorm = 0.4621, lr_0 = 2.5222e-04
Loss = 1.8821e-01, PNorm = 37.7626, GNorm = 0.6669, lr_0 = 2.4653e-04
Loss = 1.8455e-01, PNorm = 37.7892, GNorm = 1.3486, lr_0 = 2.4096e-04
Validation auc = 0.899141
Epoch 19
Loss = 1.7566e-01, PNorm = 37.8102, GNorm = 0.6313, lr_0 = 2.3498e-04
Loss = 1.6993e-01, PNorm = 37.8403, GNorm = 0.3876, lr_0 = 2.2967e-04
Loss = 1.8237e-01, PNorm = 37.8641, GNorm = 0.4947, lr_0 = 2.2449e-04
Loss = 1.8445e-01, PNorm = 37.8866, GNorm = 0.6160, lr_0 = 2.1942e-04
Validation auc = 0.905713
Epoch 20
Loss = 1.4986e-01, PNorm = 37.9091, GNorm = 0.7654, lr_0 = 2.1397e-04
Loss = 1.6749e-01, PNorm = 37.9366, GNorm = 0.3789, lr_0 = 2.0914e-04
Loss = 1.8715e-01, PNorm = 37.9571, GNorm = 0.5185, lr_0 = 2.0442e-04
Loss = 1.6805e-01, PNorm = 37.9774, GNorm = 0.6331, lr_0 = 1.9980e-04
Validation auc = 0.904954
Epoch 21
Loss = 1.6750e-01, PNorm = 38.0006, GNorm = 0.6901, lr_0 = 1.9529e-04
Loss = 1.8500e-01, PNorm = 38.0238, GNorm = 0.3541, lr_0 = 1.9088e-04
Loss = 1.6190e-01, PNorm = 38.0434, GNorm = 0.4112, lr_0 = 1.8657e-04
Validation auc = 0.902932
Epoch 22
Loss = 1.4804e-01, PNorm = 38.0627, GNorm = 1.0826, lr_0 = 1.8194e-04
Loss = 1.9196e-01, PNorm = 38.0824, GNorm = 1.8587, lr_0 = 1.7783e-04
Loss = 1.4906e-01, PNorm = 38.1002, GNorm = 0.3328, lr_0 = 1.7381e-04
Loss = 1.5753e-01, PNorm = 38.1204, GNorm = 0.4245, lr_0 = 1.6989e-04
Validation auc = 0.906598
Epoch 23
Loss = 1.8232e-01, PNorm = 38.1393, GNorm = 1.1297, lr_0 = 1.6567e-04
Loss = 1.7193e-01, PNorm = 38.1580, GNorm = 0.7396, lr_0 = 1.6193e-04
Loss = 1.4871e-01, PNorm = 38.1791, GNorm = 0.3124, lr_0 = 1.5827e-04
Validation auc = 0.907230
Epoch 24
Loss = 2.0072e-01, PNorm = 38.1977, GNorm = 0.9775, lr_0 = 1.5434e-04
Loss = 1.5371e-01, PNorm = 38.2116, GNorm = 0.6536, lr_0 = 1.5086e-04
Loss = 1.4377e-01, PNorm = 38.2283, GNorm = 0.5500, lr_0 = 1.4745e-04
Loss = 1.5008e-01, PNorm = 38.2442, GNorm = 0.8377, lr_0 = 1.4412e-04
Validation auc = 0.908620
Epoch 25
Loss = 2.0399e-01, PNorm = 38.2642, GNorm = 0.6564, lr_0 = 1.4087e-04
Loss = 1.5706e-01, PNorm = 38.2796, GNorm = 0.4516, lr_0 = 1.3769e-04
Loss = 1.4038e-01, PNorm = 38.2942, GNorm = 0.8936, lr_0 = 1.3458e-04
Loss = 1.6153e-01, PNorm = 38.3106, GNorm = 0.5560, lr_0 = 1.3154e-04
Validation auc = 0.907861
Epoch 26
Loss = 1.6804e-01, PNorm = 38.3285, GNorm = 0.3531, lr_0 = 1.2827e-04
Loss = 1.3258e-01, PNorm = 38.3442, GNorm = 0.5637, lr_0 = 1.2538e-04
Loss = 1.2962e-01, PNorm = 38.3576, GNorm = 0.7590, lr_0 = 1.2254e-04
Validation auc = 0.903943
Epoch 27
Loss = 1.3546e-01, PNorm = 38.3702, GNorm = 0.9304, lr_0 = 1.1950e-04
Loss = 1.4218e-01, PNorm = 38.3825, GNorm = 1.1257, lr_0 = 1.1680e-04
Loss = 1.4487e-01, PNorm = 38.3947, GNorm = 0.3984, lr_0 = 1.1417e-04
Loss = 1.5552e-01, PNorm = 38.4079, GNorm = 0.5204, lr_0 = 1.1159e-04
Validation auc = 0.910768
Epoch 28
Loss = 1.4414e-01, PNorm = 38.4237, GNorm = 0.3983, lr_0 = 1.0882e-04
Loss = 1.4030e-01, PNorm = 38.4372, GNorm = 0.4739, lr_0 = 1.0636e-04
Loss = 1.4890e-01, PNorm = 38.4478, GNorm = 0.4275, lr_0 = 1.0396e-04
Loss = 1.5114e-01, PNorm = 38.4595, GNorm = 0.4631, lr_0 = 1.0161e-04
Loss = 4.7948e-02, PNorm = 38.4608, GNorm = 0.8877, lr_0 = 1.0138e-04
Validation auc = 0.909631
Epoch 29
Loss = 1.2077e-01, PNorm = 38.4730, GNorm = 0.2805, lr_0 = 1.0000e-04
Loss = 1.2762e-01, PNorm = 38.4851, GNorm = 0.7724, lr_0 = 1.0000e-04
Loss = 1.6874e-01, PNorm = 38.4971, GNorm = 0.9300, lr_0 = 1.0000e-04
Validation auc = 0.914939
Model 0 best validation auc = 0.914939 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test auc = 0.954657
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 415,201
Moving model to cuda
Epoch 0
Loss = 4.6879e-01, PNorm = 35.0719, GNorm = 0.5417, lr_0 = 2.3750e-04
Loss = 4.6405e-01, PNorm = 35.0765, GNorm = 0.4383, lr_0 = 3.6250e-04
Loss = 4.0503e-01, PNorm = 35.0954, GNorm = 0.4963, lr_0 = 4.8750e-04
Validation auc = 0.831016
Epoch 1
Loss = 3.2180e-01, PNorm = 35.1282, GNorm = 0.4295, lr_0 = 6.2500e-04
Loss = 3.3681e-01, PNorm = 35.1742, GNorm = 0.4675, lr_0 = 7.5000e-04
Loss = 4.0404e-01, PNorm = 35.2019, GNorm = 1.0684, lr_0 = 8.7500e-04
Loss = 3.4298e-01, PNorm = 35.2469, GNorm = 1.1835, lr_0 = 1.0000e-03
Validation auc = 0.857305
Epoch 2
Loss = 3.0993e-01, PNorm = 35.3052, GNorm = 0.5838, lr_0 = 9.7519e-04
Loss = 3.1182e-01, PNorm = 35.3563, GNorm = 0.3853, lr_0 = 9.5316e-04
Loss = 3.4628e-01, PNorm = 35.4036, GNorm = 1.2610, lr_0 = 9.3164e-04
Validation auc = 0.863246
Epoch 3
Loss = 2.7987e-01, PNorm = 35.4460, GNorm = 0.4971, lr_0 = 9.0852e-04
Loss = 3.0532e-01, PNorm = 35.4877, GNorm = 0.8778, lr_0 = 8.8800e-04
Loss = 2.9968e-01, PNorm = 35.5298, GNorm = 0.5363, lr_0 = 8.6794e-04
Loss = 2.8644e-01, PNorm = 35.5711, GNorm = 0.5598, lr_0 = 8.4834e-04
Validation auc = 0.866785
Epoch 4
Loss = 2.8524e-01, PNorm = 35.6265, GNorm = 0.4508, lr_0 = 8.2729e-04
Loss = 2.8374e-01, PNorm = 35.6825, GNorm = 0.6246, lr_0 = 8.0861e-04
Loss = 2.7671e-01, PNorm = 35.7342, GNorm = 0.2992, lr_0 = 7.9035e-04
Loss = 2.9991e-01, PNorm = 35.7755, GNorm = 0.8586, lr_0 = 7.7250e-04
Validation auc = 0.869944
Epoch 5
Loss = 2.5923e-01, PNorm = 35.8293, GNorm = 1.0018, lr_0 = 7.5505e-04
Loss = 2.7930e-01, PNorm = 35.8885, GNorm = 1.4541, lr_0 = 7.3800e-04
Loss = 2.7466e-01, PNorm = 35.9396, GNorm = 0.9643, lr_0 = 7.2133e-04
Validation auc = 0.874368
Epoch 6
Loss = 2.6721e-01, PNorm = 35.9883, GNorm = 0.6057, lr_0 = 7.0343e-04
Loss = 2.5736e-01, PNorm = 36.0475, GNorm = 0.4598, lr_0 = 6.8755e-04
Loss = 2.1913e-01, PNorm = 36.0980, GNorm = 1.6923, lr_0 = 6.7202e-04
Loss = 3.1108e-01, PNorm = 36.1469, GNorm = 0.9693, lr_0 = 6.5684e-04
Validation auc = 0.879424
Epoch 7
Loss = 2.4142e-01, PNorm = 36.1906, GNorm = 1.7473, lr_0 = 6.4054e-04
Loss = 2.9129e-01, PNorm = 36.2401, GNorm = 0.2625, lr_0 = 6.2608e-04
Loss = 2.8199e-01, PNorm = 36.2895, GNorm = 0.5931, lr_0 = 6.1194e-04
Validation auc = 0.878792
Epoch 8
Loss = 2.3315e-01, PNorm = 36.3505, GNorm = 0.4461, lr_0 = 5.9675e-04
Loss = 2.4805e-01, PNorm = 36.4072, GNorm = 0.5337, lr_0 = 5.8327e-04
Loss = 2.1338e-01, PNorm = 36.4636, GNorm = 0.5803, lr_0 = 5.7010e-04
Loss = 2.5674e-01, PNorm = 36.5013, GNorm = 0.5057, lr_0 = 5.5723e-04
Validation auc = 0.881067
Epoch 9
Loss = 2.2928e-01, PNorm = 36.5419, GNorm = 0.5791, lr_0 = 5.4464e-04
Loss = 2.6786e-01, PNorm = 36.5893, GNorm = 0.5429, lr_0 = 5.3234e-04
Loss = 2.2655e-01, PNorm = 36.6315, GNorm = 0.5808, lr_0 = 5.2032e-04
Loss = 1.9620e-01, PNorm = 36.6833, GNorm = 0.5034, lr_0 = 5.0857e-04
Validation auc = 0.883468
Epoch 10
Loss = 2.3123e-01, PNorm = 36.7318, GNorm = 0.5433, lr_0 = 4.9595e-04
Loss = 2.3447e-01, PNorm = 36.7804, GNorm = 1.1588, lr_0 = 4.8475e-04
Loss = 2.3004e-01, PNorm = 36.8268, GNorm = 0.7627, lr_0 = 4.7380e-04
Validation auc = 0.883215
Epoch 11
Loss = 2.3413e-01, PNorm = 36.8737, GNorm = 0.6281, lr_0 = 4.6204e-04
Loss = 2.2075e-01, PNorm = 36.9184, GNorm = 0.4421, lr_0 = 4.5161e-04
Loss = 1.9755e-01, PNorm = 36.9586, GNorm = 0.5366, lr_0 = 4.4141e-04
Loss = 2.2836e-01, PNorm = 37.0077, GNorm = 1.2113, lr_0 = 4.3144e-04
Validation auc = 0.887007
Epoch 12
Loss = 2.3349e-01, PNorm = 37.0535, GNorm = 0.3670, lr_0 = 4.2073e-04
Loss = 2.5563e-01, PNorm = 37.1032, GNorm = 0.8487, lr_0 = 4.1123e-04
Loss = 2.1180e-01, PNorm = 37.1415, GNorm = 0.4016, lr_0 = 4.0195e-04
Loss = 2.1516e-01, PNorm = 37.1770, GNorm = 0.4779, lr_0 = 3.9287e-04
Validation auc = 0.890293
Epoch 13
Loss = 2.2085e-01, PNorm = 37.2179, GNorm = 0.6434, lr_0 = 3.8399e-04
Loss = 1.9936e-01, PNorm = 37.2561, GNorm = 1.2900, lr_0 = 3.7532e-04
Loss = 2.0532e-01, PNorm = 37.2889, GNorm = 0.3742, lr_0 = 3.6685e-04
Validation auc = 0.890546
Epoch 14
Loss = 2.4133e-01, PNorm = 37.3283, GNorm = 0.9441, lr_0 = 3.5774e-04
Loss = 1.5665e-01, PNorm = 37.3670, GNorm = 0.4145, lr_0 = 3.4966e-04
Loss = 2.0726e-01, PNorm = 37.4047, GNorm = 0.8642, lr_0 = 3.4177e-04
Loss = 2.3204e-01, PNorm = 37.4386, GNorm = 0.4960, lr_0 = 3.3405e-04
Validation auc = 0.892821
Epoch 15
Loss = 2.1738e-01, PNorm = 37.4772, GNorm = 0.5045, lr_0 = 3.2576e-04
Loss = 1.9194e-01, PNorm = 37.5176, GNorm = 0.6909, lr_0 = 3.1840e-04
Loss = 1.8873e-01, PNorm = 37.5502, GNorm = 0.5149, lr_0 = 3.1121e-04
Validation auc = 0.895096
Epoch 16
Loss = 1.2986e-01, PNorm = 37.5862, GNorm = 0.5517, lr_0 = 3.0349e-04
Loss = 1.8621e-01, PNorm = 37.6210, GNorm = 0.9376, lr_0 = 2.9663e-04
Loss = 1.8614e-01, PNorm = 37.6570, GNorm = 1.5435, lr_0 = 2.8994e-04
Loss = 1.9036e-01, PNorm = 37.6905, GNorm = 0.5022, lr_0 = 2.8339e-04
Validation auc = 0.899772
Epoch 17
Loss = 1.8848e-01, PNorm = 37.7171, GNorm = 1.5569, lr_0 = 2.7699e-04
Loss = 2.1428e-01, PNorm = 37.7478, GNorm = 1.0832, lr_0 = 2.7073e-04
Loss = 1.8106e-01, PNorm = 37.7831, GNorm = 0.4251, lr_0 = 2.6462e-04
Loss = 1.6159e-01, PNorm = 37.8109, GNorm = 0.5158, lr_0 = 2.5864e-04
Validation auc = 0.893832
Epoch 18
Loss = 1.8858e-01, PNorm = 37.8413, GNorm = 0.3697, lr_0 = 2.5222e-04
Loss = 1.8828e-01, PNorm = 37.8742, GNorm = 0.5172, lr_0 = 2.4653e-04
Loss = 1.7507e-01, PNorm = 37.9052, GNorm = 0.5137, lr_0 = 2.4096e-04
Validation auc = 0.899899
Epoch 19
Loss = 2.2140e-01, PNorm = 37.9317, GNorm = 0.9565, lr_0 = 2.3498e-04
Loss = 1.5678e-01, PNorm = 37.9550, GNorm = 0.4281, lr_0 = 2.2967e-04
Loss = 1.8804e-01, PNorm = 37.9799, GNorm = 0.6206, lr_0 = 2.2449e-04
Loss = 1.5319e-01, PNorm = 38.0072, GNorm = 0.5436, lr_0 = 2.1942e-04
Validation auc = 0.900404
Epoch 20
Loss = 1.4032e-01, PNorm = 38.0356, GNorm = 0.3284, lr_0 = 2.1397e-04
Loss = 1.7980e-01, PNorm = 38.0562, GNorm = 1.4782, lr_0 = 2.0914e-04
Loss = 1.8179e-01, PNorm = 38.0833, GNorm = 0.9889, lr_0 = 2.0442e-04
Loss = 1.5943e-01, PNorm = 38.1108, GNorm = 1.0649, lr_0 = 1.9980e-04
Validation auc = 0.904449
Epoch 21
Loss = 1.6560e-01, PNorm = 38.1323, GNorm = 0.8724, lr_0 = 1.9529e-04
Loss = 1.4721e-01, PNorm = 38.1577, GNorm = 1.0324, lr_0 = 1.9088e-04
Loss = 1.7668e-01, PNorm = 38.1799, GNorm = 1.1293, lr_0 = 1.8657e-04
Validation auc = 0.904323
Epoch 22
Loss = 1.5456e-01, PNorm = 38.2022, GNorm = 0.4977, lr_0 = 1.8194e-04
Loss = 1.4035e-01, PNorm = 38.2259, GNorm = 0.6679, lr_0 = 1.7783e-04
Loss = 1.5998e-01, PNorm = 38.2432, GNorm = 0.4441, lr_0 = 1.7381e-04
Loss = 1.6796e-01, PNorm = 38.2637, GNorm = 0.4580, lr_0 = 1.6989e-04
Validation auc = 0.906471
Epoch 23
Loss = 1.5094e-01, PNorm = 38.2867, GNorm = 0.7699, lr_0 = 1.6567e-04
Loss = 1.7380e-01, PNorm = 38.3039, GNorm = 0.4570, lr_0 = 1.6193e-04
Loss = 1.2418e-01, PNorm = 38.3226, GNorm = 0.6576, lr_0 = 1.5827e-04
Validation auc = 0.902553
Epoch 24
Loss = 1.6257e-01, PNorm = 38.3438, GNorm = 0.6833, lr_0 = 1.5434e-04
Loss = 1.4552e-01, PNorm = 38.3618, GNorm = 0.4485, lr_0 = 1.5086e-04
Loss = 1.6320e-01, PNorm = 38.3784, GNorm = 0.9240, lr_0 = 1.4745e-04
Loss = 1.4220e-01, PNorm = 38.3984, GNorm = 0.6568, lr_0 = 1.4412e-04
Validation auc = 0.905207
Epoch 25
Loss = 1.6399e-01, PNorm = 38.4162, GNorm = 1.5439, lr_0 = 1.4087e-04
Loss = 1.5406e-01, PNorm = 38.4351, GNorm = 0.8200, lr_0 = 1.3769e-04
Loss = 1.4207e-01, PNorm = 38.4492, GNorm = 0.4300, lr_0 = 1.3458e-04
Loss = 1.5734e-01, PNorm = 38.4652, GNorm = 1.3275, lr_0 = 1.3154e-04
Validation auc = 0.904323
Epoch 26
Loss = 1.2089e-01, PNorm = 38.4863, GNorm = 0.4134, lr_0 = 1.2827e-04
Loss = 1.7665e-01, PNorm = 38.5030, GNorm = 0.8892, lr_0 = 1.2538e-04
Loss = 1.3110e-01, PNorm = 38.5188, GNorm = 0.9367, lr_0 = 1.2254e-04
Validation auc = 0.906598
Epoch 27
Loss = 1.5974e-01, PNorm = 38.5341, GNorm = 1.1054, lr_0 = 1.1950e-04
Loss = 1.4183e-01, PNorm = 38.5482, GNorm = 0.7341, lr_0 = 1.1680e-04
Loss = 1.4285e-01, PNorm = 38.5593, GNorm = 0.7040, lr_0 = 1.1417e-04
Loss = 1.5140e-01, PNorm = 38.5724, GNorm = 1.0663, lr_0 = 1.1159e-04
Validation auc = 0.907103
Epoch 28
Loss = 1.2697e-01, PNorm = 38.5874, GNorm = 0.7190, lr_0 = 1.0882e-04
Loss = 1.2440e-01, PNorm = 38.6033, GNorm = 1.5319, lr_0 = 1.0636e-04
Loss = 1.3989e-01, PNorm = 38.6149, GNorm = 0.6860, lr_0 = 1.0396e-04
Loss = 1.7225e-01, PNorm = 38.6264, GNorm = 1.2459, lr_0 = 1.0161e-04
Loss = 1.5958e-01, PNorm = 38.6280, GNorm = 1.5205, lr_0 = 1.0138e-04
Validation auc = 0.909125
Epoch 29
Loss = 1.5798e-01, PNorm = 38.6412, GNorm = 0.4506, lr_0 = 1.0000e-04
Loss = 1.4649e-01, PNorm = 38.6557, GNorm = 0.4572, lr_0 = 1.0000e-04
Loss = 1.2355e-01, PNorm = 38.6671, GNorm = 0.4138, lr_0 = 1.0000e-04
Validation auc = 0.907356
Model 1 best validation auc = 0.909125 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test auc = 0.955102
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 415,201
Moving model to cuda
Epoch 0
Loss = 5.4966e-01, PNorm = 35.0611, GNorm = 1.1968, lr_0 = 2.3750e-04
Loss = 4.1893e-01, PNorm = 35.0632, GNorm = 0.9308, lr_0 = 3.6250e-04
Loss = 4.3736e-01, PNorm = 35.0747, GNorm = 0.3070, lr_0 = 4.8750e-04
Validation auc = 0.813701
Epoch 1
Loss = 3.9638e-01, PNorm = 35.0963, GNorm = 0.3517, lr_0 = 6.2500e-04
Loss = 3.5781e-01, PNorm = 35.1295, GNorm = 0.7810, lr_0 = 7.5000e-04
Loss = 3.7037e-01, PNorm = 35.1680, GNorm = 0.9296, lr_0 = 8.7500e-04
Loss = 3.8369e-01, PNorm = 35.2224, GNorm = 0.6792, lr_0 = 1.0000e-03
Validation auc = 0.844287
Epoch 2
Loss = 3.1661e-01, PNorm = 35.2796, GNorm = 0.3319, lr_0 = 9.7519e-04
Loss = 3.4599e-01, PNorm = 35.3383, GNorm = 0.2395, lr_0 = 9.5316e-04
Loss = 3.1231e-01, PNorm = 35.3853, GNorm = 0.3166, lr_0 = 9.3164e-04
Validation auc = 0.851618
Epoch 3
Loss = 3.1881e-01, PNorm = 35.4307, GNorm = 0.6582, lr_0 = 9.0852e-04
Loss = 3.0858e-01, PNorm = 35.4774, GNorm = 0.6836, lr_0 = 8.8800e-04
Loss = 2.5621e-01, PNorm = 35.5377, GNorm = 0.7639, lr_0 = 8.6794e-04
Loss = 3.1879e-01, PNorm = 35.5801, GNorm = 0.3715, lr_0 = 8.4834e-04
Validation auc = 0.861350
Epoch 4
Loss = 3.4061e-01, PNorm = 35.6167, GNorm = 0.6040, lr_0 = 8.2729e-04
Loss = 2.6074e-01, PNorm = 35.6534, GNorm = 0.8301, lr_0 = 8.0861e-04
Loss = 2.8546e-01, PNorm = 35.7009, GNorm = 0.4379, lr_0 = 7.9035e-04
Loss = 3.2454e-01, PNorm = 35.7466, GNorm = 0.2878, lr_0 = 7.7250e-04
Validation auc = 0.864383
Epoch 5
Loss = 2.9420e-01, PNorm = 35.7828, GNorm = 0.3714, lr_0 = 7.5505e-04
Loss = 2.8631e-01, PNorm = 35.8304, GNorm = 0.4811, lr_0 = 7.3800e-04
Loss = 2.7976e-01, PNorm = 35.8817, GNorm = 0.6469, lr_0 = 7.2133e-04
Validation auc = 0.862867
Epoch 6
Loss = 2.7421e-01, PNorm = 35.9276, GNorm = 0.5405, lr_0 = 7.0343e-04
Loss = 2.7441e-01, PNorm = 35.9725, GNorm = 0.3174, lr_0 = 6.8755e-04
Loss = 2.9410e-01, PNorm = 36.0162, GNorm = 0.3707, lr_0 = 6.7202e-04
Loss = 2.7515e-01, PNorm = 36.0629, GNorm = 0.4529, lr_0 = 6.5684e-04
Validation auc = 0.868933
Epoch 7
Loss = 2.7762e-01, PNorm = 36.1223, GNorm = 0.3170, lr_0 = 6.4054e-04
Loss = 2.5365e-01, PNorm = 36.1777, GNorm = 0.7463, lr_0 = 6.2608e-04
Loss = 2.6350e-01, PNorm = 36.2205, GNorm = 0.4747, lr_0 = 6.1194e-04
Validation auc = 0.865015
Epoch 8
Loss = 1.8051e-01, PNorm = 36.2739, GNorm = 0.4217, lr_0 = 5.9675e-04
Loss = 2.4358e-01, PNorm = 36.3184, GNorm = 0.5251, lr_0 = 5.8327e-04
Loss = 2.9759e-01, PNorm = 36.3653, GNorm = 0.5433, lr_0 = 5.7010e-04
Loss = 2.1839e-01, PNorm = 36.4202, GNorm = 0.4269, lr_0 = 5.5723e-04
Validation auc = 0.867669
Epoch 9
Loss = 2.9910e-01, PNorm = 36.4682, GNorm = 0.8521, lr_0 = 5.4464e-04
Loss = 2.0165e-01, PNorm = 36.5192, GNorm = 1.1447, lr_0 = 5.3234e-04
Loss = 2.1868e-01, PNorm = 36.5605, GNorm = 0.3463, lr_0 = 5.2032e-04
Loss = 2.7213e-01, PNorm = 36.6046, GNorm = 1.0284, lr_0 = 5.0857e-04
Validation auc = 0.873231
Epoch 10
Loss = 2.1696e-01, PNorm = 36.6590, GNorm = 0.8706, lr_0 = 4.9595e-04
Loss = 2.5504e-01, PNorm = 36.7114, GNorm = 0.3313, lr_0 = 4.8475e-04
Loss = 2.0212e-01, PNorm = 36.7562, GNorm = 0.4498, lr_0 = 4.7380e-04
Validation auc = 0.876517
Epoch 11
Loss = 2.7593e-01, PNorm = 36.7948, GNorm = 1.4961, lr_0 = 4.6204e-04
Loss = 2.2678e-01, PNorm = 36.8364, GNorm = 0.3312, lr_0 = 4.5161e-04
Loss = 2.1854e-01, PNorm = 36.8761, GNorm = 0.3832, lr_0 = 4.4141e-04
Loss = 2.1526e-01, PNorm = 36.9199, GNorm = 0.6780, lr_0 = 4.3144e-04
Validation auc = 0.880056
Epoch 12
Loss = 1.9623e-01, PNorm = 36.9725, GNorm = 0.4553, lr_0 = 4.2073e-04
Loss = 2.3949e-01, PNorm = 37.0156, GNorm = 0.7281, lr_0 = 4.1123e-04
Loss = 2.3851e-01, PNorm = 37.0527, GNorm = 0.3738, lr_0 = 4.0195e-04
Loss = 2.0005e-01, PNorm = 37.0913, GNorm = 0.4748, lr_0 = 3.9287e-04
Validation auc = 0.877781
Epoch 13
Loss = 1.8180e-01, PNorm = 37.1236, GNorm = 0.4759, lr_0 = 3.8399e-04
Loss = 1.9654e-01, PNorm = 37.1660, GNorm = 0.4933, lr_0 = 3.7532e-04
Loss = 2.1667e-01, PNorm = 37.2070, GNorm = 0.7766, lr_0 = 3.6685e-04
Validation auc = 0.885238
Epoch 14
Loss = 2.0856e-01, PNorm = 37.2492, GNorm = 0.5020, lr_0 = 3.5774e-04
Loss = 1.8358e-01, PNorm = 37.2891, GNorm = 0.4594, lr_0 = 3.4966e-04
Loss = 1.8249e-01, PNorm = 37.3275, GNorm = 0.8805, lr_0 = 3.4177e-04
Loss = 2.2446e-01, PNorm = 37.3606, GNorm = 0.4693, lr_0 = 3.3405e-04
Validation auc = 0.888650
Epoch 15
Loss = 1.6318e-01, PNorm = 37.4040, GNorm = 0.6936, lr_0 = 3.2576e-04
Loss = 2.0713e-01, PNorm = 37.4408, GNorm = 0.6799, lr_0 = 3.1840e-04
Loss = 1.9605e-01, PNorm = 37.4804, GNorm = 1.6232, lr_0 = 3.1121e-04
Validation auc = 0.890799
Epoch 16
Loss = 1.7101e-01, PNorm = 37.5168, GNorm = 0.5087, lr_0 = 3.0349e-04
Loss = 1.8951e-01, PNorm = 37.5498, GNorm = 0.4499, lr_0 = 2.9663e-04
Loss = 1.7896e-01, PNorm = 37.5845, GNorm = 1.4867, lr_0 = 2.8994e-04
Loss = 1.7823e-01, PNorm = 37.6104, GNorm = 0.3183, lr_0 = 2.8339e-04
Validation auc = 0.893200
Epoch 17
Loss = 2.0365e-01, PNorm = 37.6440, GNorm = 0.6659, lr_0 = 2.7699e-04
Loss = 1.5906e-01, PNorm = 37.6795, GNorm = 0.3533, lr_0 = 2.7073e-04
Loss = 1.8492e-01, PNorm = 37.7135, GNorm = 0.5550, lr_0 = 2.6462e-04
Loss = 1.8588e-01, PNorm = 37.7423, GNorm = 0.3091, lr_0 = 2.5864e-04
Validation auc = 0.889914
Epoch 18
Loss = 2.1091e-01, PNorm = 37.7728, GNorm = 0.6090, lr_0 = 2.5222e-04
Loss = 1.5275e-01, PNorm = 37.8013, GNorm = 0.4482, lr_0 = 2.4653e-04
Loss = 1.5828e-01, PNorm = 37.8281, GNorm = 0.6853, lr_0 = 2.4096e-04
Validation auc = 0.898003
Epoch 19
Loss = 2.6159e-01, PNorm = 37.8582, GNorm = 0.4944, lr_0 = 2.3498e-04
Loss = 1.3821e-01, PNorm = 37.8905, GNorm = 0.4555, lr_0 = 2.2967e-04
Loss = 2.0582e-01, PNorm = 37.9194, GNorm = 1.5231, lr_0 = 2.2449e-04
Loss = 1.5183e-01, PNorm = 37.9417, GNorm = 1.9852, lr_0 = 2.1942e-04
Validation auc = 0.890799
Epoch 20
Loss = 1.8361e-01, PNorm = 37.9686, GNorm = 0.3741, lr_0 = 2.1397e-04
Loss = 1.5901e-01, PNorm = 37.9964, GNorm = 0.3219, lr_0 = 2.0914e-04
Loss = 1.4713e-01, PNorm = 38.0241, GNorm = 0.4190, lr_0 = 2.0442e-04
Loss = 1.6582e-01, PNorm = 38.0444, GNorm = 0.4249, lr_0 = 1.9980e-04
Validation auc = 0.900152
Epoch 21
Loss = 1.5116e-01, PNorm = 38.0621, GNorm = 0.5595, lr_0 = 1.9529e-04
Loss = 1.7262e-01, PNorm = 38.0842, GNorm = 0.9571, lr_0 = 1.9088e-04
Loss = 1.6259e-01, PNorm = 38.1090, GNorm = 1.1404, lr_0 = 1.8657e-04
Validation auc = 0.902300
Epoch 22
Loss = 1.8453e-01, PNorm = 38.1326, GNorm = 0.5046, lr_0 = 1.8194e-04
Loss = 1.4656e-01, PNorm = 38.1527, GNorm = 0.5014, lr_0 = 1.7783e-04
Loss = 1.4199e-01, PNorm = 38.1731, GNorm = 0.9938, lr_0 = 1.7381e-04
Loss = 1.5940e-01, PNorm = 38.1945, GNorm = 0.4473, lr_0 = 1.6989e-04
Validation auc = 0.900784
Epoch 23
Loss = 1.9013e-01, PNorm = 38.2128, GNorm = 0.4323, lr_0 = 1.6567e-04
Loss = 1.4003e-01, PNorm = 38.2277, GNorm = 1.1916, lr_0 = 1.6193e-04
Loss = 1.4680e-01, PNorm = 38.2439, GNorm = 0.4493, lr_0 = 1.5827e-04
Validation auc = 0.903817
Epoch 24
Loss = 1.8743e-01, PNorm = 38.2651, GNorm = 0.5765, lr_0 = 1.5434e-04
Loss = 1.6068e-01, PNorm = 38.2846, GNorm = 0.3941, lr_0 = 1.5086e-04
Loss = 1.1730e-01, PNorm = 38.3048, GNorm = 0.6488, lr_0 = 1.4745e-04
Loss = 1.4327e-01, PNorm = 38.3211, GNorm = 1.4448, lr_0 = 1.4412e-04
Validation auc = 0.908241
Epoch 25
Loss = 1.1968e-01, PNorm = 38.3363, GNorm = 0.4721, lr_0 = 1.4087e-04
Loss = 1.3741e-01, PNorm = 38.3521, GNorm = 0.5741, lr_0 = 1.3769e-04
Loss = 1.5854e-01, PNorm = 38.3677, GNorm = 0.6698, lr_0 = 1.3458e-04
Loss = 1.4854e-01, PNorm = 38.3826, GNorm = 0.6210, lr_0 = 1.3154e-04
Validation auc = 0.907735
Epoch 26
Loss = 1.5680e-01, PNorm = 38.3999, GNorm = 0.5976, lr_0 = 1.2827e-04
Loss = 1.4192e-01, PNorm = 38.4142, GNorm = 0.5515, lr_0 = 1.2538e-04
Loss = 1.5306e-01, PNorm = 38.4307, GNorm = 0.7431, lr_0 = 1.2254e-04
Validation auc = 0.904575
Epoch 27
Loss = 2.0014e-01, PNorm = 38.4463, GNorm = 0.8270, lr_0 = 1.1950e-04
Loss = 1.2996e-01, PNorm = 38.4593, GNorm = 0.3949, lr_0 = 1.1680e-04
Loss = 1.1587e-01, PNorm = 38.4728, GNorm = 0.3509, lr_0 = 1.1417e-04
Loss = 1.5363e-01, PNorm = 38.4851, GNorm = 0.4807, lr_0 = 1.1159e-04
Validation auc = 0.905966
Epoch 28
Loss = 1.2357e-01, PNorm = 38.5002, GNorm = 0.7189, lr_0 = 1.0882e-04
Loss = 1.5823e-01, PNorm = 38.5129, GNorm = 0.5175, lr_0 = 1.0636e-04
Loss = 1.0308e-01, PNorm = 38.5249, GNorm = 1.1544, lr_0 = 1.0396e-04
Loss = 1.4892e-01, PNorm = 38.5371, GNorm = 0.4808, lr_0 = 1.0161e-04
Loss = 1.0954e-01, PNorm = 38.5384, GNorm = 1.2878, lr_0 = 1.0138e-04
Validation auc = 0.907356
Epoch 29
Loss = 1.6047e-01, PNorm = 38.5510, GNorm = 0.4549, lr_0 = 1.0000e-04
Loss = 1.3759e-01, PNorm = 38.5638, GNorm = 1.4896, lr_0 = 1.0000e-04
Loss = 1.1952e-01, PNorm = 38.5738, GNorm = 0.4111, lr_0 = 1.0000e-04
Validation auc = 0.901921
Model 2 best validation auc = 0.908241 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 2 test auc = 0.955102
Building model 3
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 415,201
Moving model to cuda
Epoch 0
Loss = 5.6043e-01, PNorm = 35.0649, GNorm = 2.7387, lr_0 = 2.3750e-04
Loss = 4.1190e-01, PNorm = 35.0703, GNorm = 0.3837, lr_0 = 3.6250e-04
Loss = 4.1812e-01, PNorm = 35.0872, GNorm = 2.7895, lr_0 = 4.8750e-04
Validation auc = 0.795248
Epoch 1
Loss = 4.3314e-01, PNorm = 35.1107, GNorm = 2.8008, lr_0 = 6.2500e-04
Loss = 3.9036e-01, PNorm = 35.1346, GNorm = 0.2859, lr_0 = 7.5000e-04
Loss = 3.7364e-01, PNorm = 35.1727, GNorm = 1.2418, lr_0 = 8.7500e-04
Loss = 3.6411e-01, PNorm = 35.2226, GNorm = 0.4172, lr_0 = 1.0000e-03
Validation auc = 0.834176
Epoch 2
Loss = 3.6084e-01, PNorm = 35.2950, GNorm = 0.3089, lr_0 = 9.7519e-04
Loss = 3.2290e-01, PNorm = 35.3594, GNorm = 0.5615, lr_0 = 9.5316e-04
Loss = 3.1546e-01, PNorm = 35.4112, GNorm = 0.4135, lr_0 = 9.3164e-04
Validation auc = 0.853766
Epoch 3
Loss = 3.5502e-01, PNorm = 35.4572, GNorm = 0.8529, lr_0 = 9.0852e-04
Loss = 2.7981e-01, PNorm = 35.5058, GNorm = 0.7866, lr_0 = 8.8800e-04
Loss = 3.1247e-01, PNorm = 35.5483, GNorm = 0.3129, lr_0 = 8.6794e-04
Loss = 3.2831e-01, PNorm = 35.6012, GNorm = 0.3515, lr_0 = 8.4834e-04
Validation auc = 0.864130
Epoch 4
Loss = 2.7019e-01, PNorm = 35.6756, GNorm = 0.8358, lr_0 = 8.2729e-04
Loss = 3.0240e-01, PNorm = 35.7515, GNorm = 0.6274, lr_0 = 8.0861e-04
Loss = 3.0763e-01, PNorm = 35.7992, GNorm = 0.2208, lr_0 = 7.9035e-04
Loss = 3.0280e-01, PNorm = 35.8395, GNorm = 0.5547, lr_0 = 7.7250e-04
Validation auc = 0.855283
Epoch 5
Loss = 2.7078e-01, PNorm = 35.8821, GNorm = 0.4181, lr_0 = 7.5505e-04
Loss = 2.8085e-01, PNorm = 35.9255, GNorm = 0.7509, lr_0 = 7.3800e-04
Loss = 3.1014e-01, PNorm = 35.9855, GNorm = 1.5021, lr_0 = 7.2133e-04
Validation auc = 0.866658
Epoch 6
Loss = 3.3453e-01, PNorm = 36.0405, GNorm = 0.7206, lr_0 = 7.0343e-04
Loss = 2.7533e-01, PNorm = 36.1011, GNorm = 0.4157, lr_0 = 6.8755e-04
Loss = 2.4736e-01, PNorm = 36.1411, GNorm = 0.3330, lr_0 = 6.7202e-04
Loss = 2.6025e-01, PNorm = 36.1745, GNorm = 0.5644, lr_0 = 6.5684e-04
Validation auc = 0.872346
Epoch 7
Loss = 2.4496e-01, PNorm = 36.2336, GNorm = 1.6829, lr_0 = 6.4054e-04
Loss = 2.3554e-01, PNorm = 36.2830, GNorm = 0.4186, lr_0 = 6.2608e-04
Loss = 2.7620e-01, PNorm = 36.3358, GNorm = 0.2966, lr_0 = 6.1194e-04
Validation auc = 0.880688
Epoch 8
Loss = 2.1812e-01, PNorm = 36.3997, GNorm = 0.2775, lr_0 = 5.9675e-04
Loss = 2.7267e-01, PNorm = 36.4460, GNorm = 0.5471, lr_0 = 5.8327e-04
Loss = 2.5837e-01, PNorm = 36.4956, GNorm = 0.4570, lr_0 = 5.7010e-04
Loss = 2.2213e-01, PNorm = 36.5463, GNorm = 0.5547, lr_0 = 5.5723e-04
Validation auc = 0.883847
Epoch 9
Loss = 2.3182e-01, PNorm = 36.5935, GNorm = 0.4884, lr_0 = 5.4464e-04
Loss = 2.2846e-01, PNorm = 36.6480, GNorm = 0.4008, lr_0 = 5.3234e-04
Loss = 2.3780e-01, PNorm = 36.6860, GNorm = 0.4794, lr_0 = 5.2032e-04
Loss = 2.1784e-01, PNorm = 36.7248, GNorm = 0.4900, lr_0 = 5.0857e-04
Validation auc = 0.882331
Epoch 10
Loss = 2.3022e-01, PNorm = 36.7679, GNorm = 1.7336, lr_0 = 4.9595e-04
Loss = 2.8021e-01, PNorm = 36.8158, GNorm = 1.5528, lr_0 = 4.8475e-04
Loss = 2.2071e-01, PNorm = 36.8569, GNorm = 0.7388, lr_0 = 4.7380e-04
Validation auc = 0.885743
Epoch 11
Loss = 2.6724e-01, PNorm = 36.9052, GNorm = 0.9662, lr_0 = 4.6204e-04
Loss = 2.4932e-01, PNorm = 36.9547, GNorm = 1.7143, lr_0 = 4.5161e-04
Loss = 2.7011e-01, PNorm = 36.9932, GNorm = 1.0706, lr_0 = 4.4141e-04
Loss = 1.8696e-01, PNorm = 37.0310, GNorm = 0.3204, lr_0 = 4.3144e-04
Validation auc = 0.889408
Epoch 12
Loss = 1.4274e-01, PNorm = 37.0707, GNorm = 0.2018, lr_0 = 4.2073e-04
Loss = 2.1146e-01, PNorm = 37.1014, GNorm = 0.8756, lr_0 = 4.1123e-04
Loss = 1.9815e-01, PNorm = 37.1364, GNorm = 0.4861, lr_0 = 4.0195e-04
Loss = 2.6368e-01, PNorm = 37.1737, GNorm = 0.4256, lr_0 = 3.9287e-04
Validation auc = 0.896866
Epoch 13
Loss = 2.2155e-01, PNorm = 37.2137, GNorm = 0.7145, lr_0 = 3.8399e-04
Loss = 1.9142e-01, PNorm = 37.2473, GNorm = 0.4641, lr_0 = 3.7532e-04
Loss = 1.9286e-01, PNorm = 37.2821, GNorm = 0.7515, lr_0 = 3.6685e-04
Validation auc = 0.896613
Epoch 14
Loss = 1.8639e-01, PNorm = 37.3199, GNorm = 0.8825, lr_0 = 3.5774e-04
Loss = 2.2067e-01, PNorm = 37.3560, GNorm = 0.5047, lr_0 = 3.4966e-04
Loss = 1.9361e-01, PNorm = 37.3912, GNorm = 0.4649, lr_0 = 3.4177e-04
Loss = 1.9027e-01, PNorm = 37.4214, GNorm = 0.9223, lr_0 = 3.3405e-04
Validation auc = 0.895602
Epoch 15
Loss = 1.7605e-01, PNorm = 37.4580, GNorm = 0.4522, lr_0 = 3.2576e-04
Loss = 2.2143e-01, PNorm = 37.4927, GNorm = 0.5494, lr_0 = 3.1840e-04
Loss = 1.7444e-01, PNorm = 37.5256, GNorm = 0.4603, lr_0 = 3.1121e-04
Validation auc = 0.897624
Epoch 16
Loss = 1.8730e-01, PNorm = 37.5570, GNorm = 0.9601, lr_0 = 3.0349e-04
Loss = 1.6943e-01, PNorm = 37.5923, GNorm = 0.3009, lr_0 = 2.9663e-04
Loss = 2.2727e-01, PNorm = 37.6208, GNorm = 0.4821, lr_0 = 2.8994e-04
Loss = 1.5669e-01, PNorm = 37.6502, GNorm = 0.5114, lr_0 = 2.8339e-04
Validation auc = 0.899772
Epoch 17
Loss = 2.1509e-01, PNorm = 37.6720, GNorm = 0.4709, lr_0 = 2.7699e-04
Loss = 1.8428e-01, PNorm = 37.6970, GNorm = 0.4782, lr_0 = 2.7073e-04
Loss = 1.7241e-01, PNorm = 37.7258, GNorm = 0.3586, lr_0 = 2.6462e-04
Loss = 1.8050e-01, PNorm = 37.7501, GNorm = 0.4139, lr_0 = 2.5864e-04
Validation auc = 0.902427
Epoch 18
Loss = 1.7019e-01, PNorm = 37.7814, GNorm = 1.0480, lr_0 = 2.5222e-04
Loss = 1.7656e-01, PNorm = 37.8052, GNorm = 0.4652, lr_0 = 2.4653e-04
Loss = 1.8748e-01, PNorm = 37.8302, GNorm = 0.4751, lr_0 = 2.4096e-04
Validation auc = 0.903564
Epoch 19
Loss = 1.6729e-01, PNorm = 37.8614, GNorm = 0.5375, lr_0 = 2.3498e-04
Loss = 1.9460e-01, PNorm = 37.8895, GNorm = 0.3710, lr_0 = 2.2967e-04
Loss = 1.8347e-01, PNorm = 37.9133, GNorm = 0.8416, lr_0 = 2.2449e-04
Loss = 1.5166e-01, PNorm = 37.9403, GNorm = 0.4960, lr_0 = 2.1942e-04
Validation auc = 0.899141
Epoch 20
Loss = 1.4565e-01, PNorm = 37.9663, GNorm = 0.2918, lr_0 = 2.1397e-04
Loss = 1.7627e-01, PNorm = 37.9891, GNorm = 0.3522, lr_0 = 2.0914e-04
Loss = 1.8070e-01, PNorm = 38.0119, GNorm = 0.4430, lr_0 = 2.0442e-04
Loss = 1.6956e-01, PNorm = 38.0329, GNorm = 0.4096, lr_0 = 1.9980e-04
Validation auc = 0.904828
Epoch 21
Loss = 1.6058e-01, PNorm = 38.0557, GNorm = 0.5211, lr_0 = 1.9529e-04
Loss = 1.8121e-01, PNorm = 38.0783, GNorm = 0.7377, lr_0 = 1.9088e-04
Loss = 1.7121e-01, PNorm = 38.1013, GNorm = 1.0067, lr_0 = 1.8657e-04
Validation auc = 0.902679
Epoch 22
Loss = 1.3737e-01, PNorm = 38.1244, GNorm = 0.4935, lr_0 = 1.8194e-04
Loss = 1.6944e-01, PNorm = 38.1443, GNorm = 0.4169, lr_0 = 1.7783e-04
Loss = 1.4502e-01, PNorm = 38.1652, GNorm = 0.3403, lr_0 = 1.7381e-04
Loss = 1.5553e-01, PNorm = 38.1840, GNorm = 0.3070, lr_0 = 1.6989e-04
Validation auc = 0.908241
Epoch 23
Loss = 1.5327e-01, PNorm = 38.2055, GNorm = 0.4164, lr_0 = 1.6567e-04
Loss = 1.6733e-01, PNorm = 38.2267, GNorm = 0.4827, lr_0 = 1.6193e-04
Loss = 1.7288e-01, PNorm = 38.2448, GNorm = 0.7932, lr_0 = 1.5827e-04
Validation auc = 0.907861
Epoch 24
Loss = 1.9995e-01, PNorm = 38.2620, GNorm = 0.6764, lr_0 = 1.5434e-04
Loss = 1.5150e-01, PNorm = 38.2804, GNorm = 0.5974, lr_0 = 1.5086e-04
Loss = 1.5941e-01, PNorm = 38.2982, GNorm = 0.8364, lr_0 = 1.4745e-04
Loss = 1.3630e-01, PNorm = 38.3127, GNorm = 1.2125, lr_0 = 1.4412e-04
Validation auc = 0.907861
Epoch 25
Loss = 1.3405e-01, PNorm = 38.3269, GNorm = 0.9034, lr_0 = 1.4087e-04
Loss = 1.4753e-01, PNorm = 38.3442, GNorm = 0.9347, lr_0 = 1.3769e-04
Loss = 1.6535e-01, PNorm = 38.3599, GNorm = 0.4093, lr_0 = 1.3458e-04
Loss = 1.5505e-01, PNorm = 38.3756, GNorm = 0.5537, lr_0 = 1.3154e-04
Validation auc = 0.908999
Epoch 26
Loss = 1.4990e-01, PNorm = 38.3926, GNorm = 0.4465, lr_0 = 1.2827e-04
Loss = 1.6127e-01, PNorm = 38.4066, GNorm = 0.5723, lr_0 = 1.2538e-04
Loss = 1.4791e-01, PNorm = 38.4194, GNorm = 0.7562, lr_0 = 1.2254e-04
Validation auc = 0.908241
Epoch 27
Loss = 1.2349e-01, PNorm = 38.4373, GNorm = 0.3730, lr_0 = 1.1950e-04
Loss = 1.7637e-01, PNorm = 38.4508, GNorm = 0.4679, lr_0 = 1.1680e-04
Loss = 1.2537e-01, PNorm = 38.4658, GNorm = 0.3745, lr_0 = 1.1417e-04
Loss = 1.4357e-01, PNorm = 38.4795, GNorm = 1.0381, lr_0 = 1.1159e-04
Validation auc = 0.907735
Epoch 28
Loss = 1.7557e-01, PNorm = 38.4939, GNorm = 0.5027, lr_0 = 1.0882e-04
Loss = 1.2814e-01, PNorm = 38.5086, GNorm = 0.3795, lr_0 = 1.0636e-04
Loss = 1.7055e-01, PNorm = 38.5225, GNorm = 0.6164, lr_0 = 1.0396e-04
Loss = 1.1378e-01, PNorm = 38.5328, GNorm = 0.4046, lr_0 = 1.0161e-04
Loss = 6.3426e-02, PNorm = 38.5338, GNorm = 1.1980, lr_0 = 1.0138e-04
Validation auc = 0.908241
Epoch 29
Loss = 1.2997e-01, PNorm = 38.5445, GNorm = 0.6005, lr_0 = 1.0000e-04
Loss = 1.5544e-01, PNorm = 38.5550, GNorm = 0.4610, lr_0 = 1.0000e-04
Loss = 1.2237e-01, PNorm = 38.5654, GNorm = 0.4412, lr_0 = 1.0000e-04
Validation auc = 0.912538
Model 3 best validation auc = 0.912538 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 3 test auc = 0.955771
Building model 4
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=500, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 415,201
Moving model to cuda
Epoch 0
Loss = 5.0828e-01, PNorm = 35.0211, GNorm = 1.3007, lr_0 = 2.3750e-04
Loss = 4.5079e-01, PNorm = 35.0222, GNorm = 0.6743, lr_0 = 3.6250e-04
Loss = 4.6775e-01, PNorm = 35.0329, GNorm = 1.0870, lr_0 = 4.8750e-04
Validation auc = 0.784505
Epoch 1
Loss = 3.3029e-01, PNorm = 35.0604, GNorm = 0.6048, lr_0 = 6.2500e-04
Loss = 3.8519e-01, PNorm = 35.0999, GNorm = 1.1310, lr_0 = 7.5000e-04
Loss = 3.3388e-01, PNorm = 35.1484, GNorm = 0.8739, lr_0 = 8.7500e-04
Loss = 3.9582e-01, PNorm = 35.2024, GNorm = 0.6322, lr_0 = 1.0000e-03
Validation auc = 0.833670
Epoch 2
Loss = 3.6081e-01, PNorm = 35.2780, GNorm = 0.4335, lr_0 = 9.7519e-04
Loss = 2.8476e-01, PNorm = 35.3526, GNorm = 0.5443, lr_0 = 9.5316e-04
Loss = 3.3720e-01, PNorm = 35.4235, GNorm = 0.6339, lr_0 = 9.3164e-04
Validation auc = 0.850859
Epoch 3
Loss = 2.6551e-01, PNorm = 35.4634, GNorm = 0.4792, lr_0 = 9.0852e-04
Loss = 3.1631e-01, PNorm = 35.5057, GNorm = 0.2926, lr_0 = 8.8800e-04
Loss = 3.0118e-01, PNorm = 35.5550, GNorm = 0.3046, lr_0 = 8.6794e-04
Loss = 3.0258e-01, PNorm = 35.5963, GNorm = 0.2823, lr_0 = 8.4834e-04
Validation auc = 0.850101
Epoch 4
Loss = 2.8539e-01, PNorm = 35.6359, GNorm = 0.8341, lr_0 = 8.2729e-04
Loss = 2.9795e-01, PNorm = 35.6756, GNorm = 0.3470, lr_0 = 8.0861e-04
Loss = 2.7833e-01, PNorm = 35.7171, GNorm = 0.2617, lr_0 = 7.9035e-04
Loss = 3.0453e-01, PNorm = 35.7585, GNorm = 0.9799, lr_0 = 7.7250e-04
Validation auc = 0.858443
Epoch 5
Loss = 2.7708e-01, PNorm = 35.7950, GNorm = 0.7657, lr_0 = 7.5505e-04
Loss = 2.5585e-01, PNorm = 35.8389, GNorm = 1.2138, lr_0 = 7.3800e-04
Loss = 3.2607e-01, PNorm = 35.8883, GNorm = 0.2952, lr_0 = 7.2133e-04
Validation auc = 0.865015
Epoch 6
Loss = 3.5764e-01, PNorm = 35.9368, GNorm = 1.3953, lr_0 = 7.0343e-04
Loss = 2.3895e-01, PNorm = 35.9775, GNorm = 0.6905, lr_0 = 6.8755e-04
Loss = 3.0424e-01, PNorm = 36.0377, GNorm = 0.9325, lr_0 = 6.7202e-04
Loss = 2.2958e-01, PNorm = 36.0910, GNorm = 0.2648, lr_0 = 6.5684e-04
Validation auc = 0.870450
Epoch 7
Loss = 2.3038e-01, PNorm = 36.1345, GNorm = 0.7726, lr_0 = 6.4054e-04
Loss = 2.5534e-01, PNorm = 36.1802, GNorm = 0.4570, lr_0 = 6.2608e-04
Loss = 2.7411e-01, PNorm = 36.2320, GNorm = 0.4723, lr_0 = 6.1194e-04
Validation auc = 0.871714
Epoch 8
Loss = 2.0105e-01, PNorm = 36.2903, GNorm = 1.0653, lr_0 = 5.9675e-04
Loss = 2.3103e-01, PNorm = 36.3328, GNorm = 0.3385, lr_0 = 5.8327e-04
Loss = 2.5870e-01, PNorm = 36.3747, GNorm = 0.2732, lr_0 = 5.7010e-04
Loss = 2.7231e-01, PNorm = 36.4143, GNorm = 0.9632, lr_0 = 5.5723e-04
Validation auc = 0.877149
Epoch 9
Loss = 1.7468e-01, PNorm = 36.4601, GNorm = 0.6118, lr_0 = 5.4464e-04
Loss = 2.4509e-01, PNorm = 36.5046, GNorm = 0.4436, lr_0 = 5.3234e-04
Loss = 2.5412e-01, PNorm = 36.5556, GNorm = 0.8399, lr_0 = 5.2032e-04
Loss = 2.5291e-01, PNorm = 36.5903, GNorm = 0.5887, lr_0 = 5.0857e-04
Validation auc = 0.879424
Epoch 10
Loss = 2.0718e-01, PNorm = 36.6365, GNorm = 0.6461, lr_0 = 4.9595e-04
Loss = 2.7894e-01, PNorm = 36.6729, GNorm = 0.9256, lr_0 = 4.8475e-04
Loss = 2.3047e-01, PNorm = 36.7166, GNorm = 0.4982, lr_0 = 4.7380e-04
Validation auc = 0.881951
Epoch 11
Loss = 3.7606e-01, PNorm = 36.7632, GNorm = 1.9500, lr_0 = 4.6204e-04
Loss = 1.8223e-01, PNorm = 36.8073, GNorm = 0.2916, lr_0 = 4.5161e-04
Loss = 2.4733e-01, PNorm = 36.8501, GNorm = 0.8723, lr_0 = 4.4141e-04
Loss = 2.2575e-01, PNorm = 36.8854, GNorm = 0.4390, lr_0 = 4.3144e-04
Validation auc = 0.886628
Epoch 12
Loss = 2.0073e-01, PNorm = 36.9219, GNorm = 0.8277, lr_0 = 4.2073e-04
Loss = 2.2123e-01, PNorm = 36.9609, GNorm = 0.6308, lr_0 = 4.1123e-04
Loss = 2.0929e-01, PNorm = 37.0021, GNorm = 0.4406, lr_0 = 4.0195e-04
Loss = 2.4291e-01, PNorm = 37.0349, GNorm = 1.1582, lr_0 = 3.9287e-04
Validation auc = 0.891178
Epoch 13
Loss = 2.0173e-01, PNorm = 37.0621, GNorm = 1.1920, lr_0 = 3.8399e-04
Loss = 2.1019e-01, PNorm = 37.0986, GNorm = 0.4828, lr_0 = 3.7532e-04
Loss = 2.2372e-01, PNorm = 37.1364, GNorm = 0.4491, lr_0 = 3.6685e-04
Validation auc = 0.892947
Epoch 14
Loss = 2.0227e-01, PNorm = 37.1739, GNorm = 1.0482, lr_0 = 3.5774e-04
Loss = 2.2569e-01, PNorm = 37.2060, GNorm = 0.3185, lr_0 = 3.4966e-04
Loss = 1.8104e-01, PNorm = 37.2412, GNorm = 0.3402, lr_0 = 3.4177e-04
Loss = 2.1375e-01, PNorm = 37.2733, GNorm = 0.4108, lr_0 = 3.3405e-04
Validation auc = 0.892568
Epoch 15
Loss = 1.6115e-01, PNorm = 37.3122, GNorm = 0.6616, lr_0 = 3.2576e-04
Loss = 1.9094e-01, PNorm = 37.3456, GNorm = 0.4601, lr_0 = 3.1840e-04
Loss = 2.3887e-01, PNorm = 37.3707, GNorm = 0.9278, lr_0 = 3.1121e-04
Validation auc = 0.894085
Epoch 16
Loss = 2.3094e-01, PNorm = 37.4013, GNorm = 0.3462, lr_0 = 3.0349e-04
Loss = 2.1381e-01, PNorm = 37.4374, GNorm = 0.6133, lr_0 = 2.9663e-04
Loss = 1.6880e-01, PNorm = 37.4724, GNorm = 0.5544, lr_0 = 2.8994e-04
Loss = 1.9887e-01, PNorm = 37.4993, GNorm = 0.4307, lr_0 = 2.8339e-04
Validation auc = 0.896992
Epoch 17
Loss = 2.0081e-01, PNorm = 37.5239, GNorm = 0.3685, lr_0 = 2.7699e-04
Loss = 1.8303e-01, PNorm = 37.5504, GNorm = 0.4468, lr_0 = 2.7073e-04
Loss = 1.7225e-01, PNorm = 37.5771, GNorm = 0.7865, lr_0 = 2.6462e-04
Loss = 2.0622e-01, PNorm = 37.6047, GNorm = 1.1223, lr_0 = 2.5864e-04
Validation auc = 0.894338
Epoch 18
Loss = 1.6203e-01, PNorm = 37.6316, GNorm = 0.8349, lr_0 = 2.5222e-04
Loss = 1.6607e-01, PNorm = 37.6562, GNorm = 0.5499, lr_0 = 2.4653e-04
Loss = 1.7426e-01, PNorm = 37.6815, GNorm = 0.4561, lr_0 = 2.4096e-04
Validation auc = 0.900278
Epoch 19
Loss = 1.5802e-01, PNorm = 37.7078, GNorm = 0.7616, lr_0 = 2.3498e-04
Loss = 2.3145e-01, PNorm = 37.7323, GNorm = 0.5420, lr_0 = 2.2967e-04
Loss = 1.7488e-01, PNorm = 37.7563, GNorm = 0.9479, lr_0 = 2.2449e-04
Loss = 1.9443e-01, PNorm = 37.7778, GNorm = 0.3700, lr_0 = 2.1942e-04
Validation auc = 0.901795
Epoch 20
Loss = 1.7503e-01, PNorm = 37.8029, GNorm = 0.6396, lr_0 = 2.1397e-04
Loss = 1.5007e-01, PNorm = 37.8297, GNorm = 0.9648, lr_0 = 2.0914e-04
Loss = 2.0391e-01, PNorm = 37.8497, GNorm = 0.6464, lr_0 = 2.0442e-04
Loss = 1.7276e-01, PNorm = 37.8670, GNorm = 0.8329, lr_0 = 1.9980e-04
Validation auc = 0.896866
Epoch 21
Loss = 1.8920e-01, PNorm = 37.8846, GNorm = 0.7836, lr_0 = 1.9529e-04
Loss = 1.4757e-01, PNorm = 37.9046, GNorm = 0.6540, lr_0 = 1.9088e-04
Loss = 1.9329e-01, PNorm = 37.9223, GNorm = 0.7027, lr_0 = 1.8657e-04
Validation auc = 0.901795
Epoch 22
Loss = 1.9113e-01, PNorm = 37.9429, GNorm = 0.6907, lr_0 = 1.8194e-04
Loss = 1.6966e-01, PNorm = 37.9606, GNorm = 0.6363, lr_0 = 1.7783e-04
Loss = 1.5316e-01, PNorm = 37.9785, GNorm = 0.8497, lr_0 = 1.7381e-04
Loss = 1.8470e-01, PNorm = 37.9953, GNorm = 0.5997, lr_0 = 1.6989e-04
Validation auc = 0.904702
Epoch 23
Loss = 1.6680e-01, PNorm = 38.0174, GNorm = 0.6440, lr_0 = 1.6567e-04
Loss = 1.6175e-01, PNorm = 38.0386, GNorm = 0.3983, lr_0 = 1.6193e-04
Loss = 1.6123e-01, PNorm = 38.0568, GNorm = 0.5660, lr_0 = 1.5827e-04
Validation auc = 0.901542
Epoch 24
Loss = 6.4286e-02, PNorm = 38.0721, GNorm = 0.5515, lr_0 = 1.5434e-04
Loss = 1.9341e-01, PNorm = 38.0882, GNorm = 1.1431, lr_0 = 1.5086e-04
Loss = 1.6259e-01, PNorm = 38.1055, GNorm = 0.3260, lr_0 = 1.4745e-04
Loss = 1.5219e-01, PNorm = 38.1208, GNorm = 0.3398, lr_0 = 1.4412e-04
Validation auc = 0.901542
Epoch 25
Loss = 1.5263e-01, PNorm = 38.1352, GNorm = 1.2764, lr_0 = 1.4087e-04
Loss = 1.4968e-01, PNorm = 38.1484, GNorm = 0.6122, lr_0 = 1.3769e-04
Loss = 1.7108e-01, PNorm = 38.1625, GNorm = 0.5372, lr_0 = 1.3458e-04
Loss = 1.5495e-01, PNorm = 38.1781, GNorm = 0.8227, lr_0 = 1.3154e-04
Validation auc = 0.903691
Epoch 26
Loss = 1.5456e-01, PNorm = 38.1903, GNorm = 0.4943, lr_0 = 1.2827e-04
Loss = 1.7607e-01, PNorm = 38.2023, GNorm = 0.5211, lr_0 = 1.2538e-04
Loss = 1.5249e-01, PNorm = 38.2148, GNorm = 0.7088, lr_0 = 1.2254e-04
Validation auc = 0.903438
Epoch 27
Loss = 1.6660e-01, PNorm = 38.2304, GNorm = 0.4919, lr_0 = 1.1950e-04
Loss = 1.7264e-01, PNorm = 38.2427, GNorm = 0.5018, lr_0 = 1.1680e-04
Loss = 1.4702e-01, PNorm = 38.2546, GNorm = 0.7655, lr_0 = 1.1417e-04
Loss = 1.4299e-01, PNorm = 38.2672, GNorm = 1.4304, lr_0 = 1.1159e-04
Validation auc = 0.902932
Epoch 28
Loss = 1.6016e-01, PNorm = 38.2802, GNorm = 0.3549, lr_0 = 1.0882e-04
Loss = 1.5106e-01, PNorm = 38.2925, GNorm = 0.8082, lr_0 = 1.0636e-04
Loss = 1.7309e-01, PNorm = 38.3046, GNorm = 0.2808, lr_0 = 1.0396e-04
Loss = 1.2517e-01, PNorm = 38.3165, GNorm = 0.8768, lr_0 = 1.0161e-04
Loss = 5.2560e-02, PNorm = 38.3177, GNorm = 0.9990, lr_0 = 1.0138e-04
Validation auc = 0.904828
Epoch 29
Loss = 1.5726e-01, PNorm = 38.3286, GNorm = 0.3715, lr_0 = 1.0000e-04
Loss = 1.2763e-01, PNorm = 38.3387, GNorm = 0.4187, lr_0 = 1.0000e-04
Loss = 1.5932e-01, PNorm = 38.3483, GNorm = 0.8865, lr_0 = 1.0000e-04
Validation auc = 0.906471
Model 4 best validation auc = 0.906471 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 4 test auc = 0.953543
Ensemble test auc = 0.955548
1-fold cross validation
	Seed 0 ==> test auc = 0.955548
Overall test auc = 0.955548 +/- 0.000000
Elapsed time = 0:06:09
